---
title: "endoSeqR Practice"
author: "Kelly Daescu"
date: "October 23, 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
This tutorial will implement the endoSeqR pipeline on a small RNA dataset. The dataset analyzed is from the following paper:
Asikainen, S., et al., Functional characterization of endogenous siRNA target genes in Caenorhabditis elegans. BMC Genomics, 2008. 9: p. 270.

The R package can be cloned from github @ https://github.com/kjdaescu/endoSeqR. The bowtie builds and dataset and information can be obtained from google drive at the following links: https://drive.google.com/drive/folders/16xoPxbzVu9Zo9_gqF16umHO_swB91kxV?usp=sharing. Available species are C elegans, S scrofa, D melanogaster, D rerio, H sapiens, M musculus, G gallus, A thaliana, X tropicalis.

Must have the following dependencies:
Linux: samtools, bedtools, bowtie
R: openxlsx, Biostrings, plyr

First time only - Installation

```{r}
library(devtools)
install("endoSeqR", lib=".")
```

To use, first load the package and its dependencies.

```{r}
library(endoSeqR)
Package_Load()
```
For bowtie to work, the parent path of the index files must be specified. The index suffixes are fixed (genomic.index.ebwt, transcriptomic.index.ebwt, reference.index.ebwt), so all that is needed is the path and species. The fasta/fastq/text file of read sequences must also be specified. 

```{r}
index<-paste0("/cb/130/kxr131930/endo.psirbase/endoSeqR_Indexes/elegans/elegans")
generate_fasta("cel.Asikainin_2008.endosiRNA.fasta","Mixed_Stage")
```
Once the package is loaded, the index is specified, and the reads are fasta formatted, the next step is to find the endo-siRNA genomic coordinates and sequences using the Map_endosiRNA function.

```{r}
Map_endosiRNA(index, "Mixed_Stage")
```

To easily access the genomic coordinates and endo-siRNA sequences, xlsx file and ".RData" files will be generated using the Import_endosiRNA command. The endosiRNA reverse complementary sequence will also be included.

```{r}
df<-Import_endosiRNA("Mixed_Stage")
colnames(df)
head(df)
```

Finally, in order to visualize the endo-siRNA population, the PlotNTLetter command can be run, as demonstrated below.

```{r}
PlotNTLetter(df)
```



